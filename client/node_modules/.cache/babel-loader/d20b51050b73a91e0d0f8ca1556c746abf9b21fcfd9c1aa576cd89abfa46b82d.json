{"ast":null,"code":"import React from\"react\";import{useNavigate}from\"react-router-dom\";import{ResponseStatus}from\"./types/ResponseStatus\";import{SERVER_API}from\"./params/params\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Login(){const[username,setUsername]=React.useState(\"\");const[password,setPassword]=React.useState(\"\");const[clearPswd,setClearPswd]=React.useState(false);const[message,setMessage]=React.useState(\"\");const nav=useNavigate();React.useEffect(()=>{(async()=>{try{const res=await fetch(\"\".concat(SERVER_API,\"/users/\"));if(res.status===200){const resBody=await res.json();if(resBody.value)nav(\"/\");}}catch(e){setMessage(\"Impossibile raggiungere il server\");}})();},[]);async function handleLogin(e){e.preventDefault();try{const res=await fetch(\"\".concat(SERVER_API,\"/users/login\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({username,password})});const resBody=await res.json();if(resBody.status===ResponseStatus.GOOD){setMessage(\"Utente authenticato\");nav(\"/\");}else{const msg=resBody.message||\"Unable lo login\";setMessage(msg);}}catch(e){setMessage(\"Credenziali errate\");}}return/*#__PURE__*/_jsxs(\"div\",{className:\"login-form\",children:[/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"username\",children:[\"Username\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"username\",value:username,onChange:e=>{setUsername(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"password\",children:[\"Password\",/*#__PURE__*/_jsx(\"input\",{type:clearPswd?\"text\":\"password\",name:\"password\",value:password,onChange:e=>setPassword(e.target.value)})]}),/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:clearPswd,onClick:()=>setClearPswd(!clearPswd)}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogin,children:\"Login\"})]}),message&&/*#__PURE__*/_jsx(\"div\",{children:message})]});}","map":{"version":3,"names":["React","useNavigate","ResponseStatus","SERVER_API","jsx","_jsx","jsxs","_jsxs","Login","username","setUsername","useState","password","setPassword","clearPswd","setClearPswd","message","setMessage","nav","useEffect","res","fetch","concat","status","resBody","json","value","e","handleLogin","preventDefault","method","headers","body","JSON","stringify","GOOD","msg","className","children","htmlFor","type","name","onChange","target","checked","onClick"],"sources":["/Users/alessioprato/Desktop/SELFIE-incompleto-/client/src/Login.tsx"],"sourcesContent":["import React from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { ResponseStatus } from \"./types/ResponseStatus\";\nimport { ResponseBody } from \"./types/ResponseBody\";\nimport { SERVER_API } from \"./params/params\";\n\nexport default function Login(): React.JSX.Element {\n\tconst [username, setUsername] = React.useState(\"\");\n\tconst [password, setPassword] = React.useState(\"\");\n\tconst [clearPswd, setClearPswd] = React.useState(false);\n\tconst [message, setMessage] = React.useState(\"\");\n\n\tconst nav = useNavigate();\n\n\tReact.useEffect(() => {\n\t\t(async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tconst res = await fetch(`${SERVER_API}/users/`);\n\t\t\t\tif (res.status === 200) {\n\t\t\t\t\tconst resBody = await res.json();\n\t\t\t\t\tif (resBody.value) nav(\"/\");\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tsetMessage(\"Impossibile raggiungere il server\");\n\t\t\t}\n\t\t})();\n\t}, []);\n\n\tasync function handleLogin(e: React.MouseEvent<HTMLButtonElement>): Promise<void> {\n\t\te.preventDefault();\n\t\ttry {\n\t\t\tconst res = await fetch(`${SERVER_API}/users/login`, {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\theaders: {\n\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify({ username, password }),\n\t\t\t});\n\n\t\t\tconst resBody: ResponseBody = await res.json();\n\t\t\tif (resBody.status === ResponseStatus.GOOD) {\n\t\t\t\tsetMessage(\"Utente authenticato\");\n\t\t\t\tnav(\"/\");\n\t\t\t} else {\n\t\t\t\tconst msg = resBody.message || \"Unable lo login\";\n\t\t\t\tsetMessage(msg);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tsetMessage(\"Credenziali errate\");\n\t\t}\n\t}\n\n\treturn (\n\t\t<div className=\"login-form\">\n\t\t\t<form>\n\t\t\t\t<label htmlFor=\"username\">\n\t\t\t\t\tUsername\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tname=\"username\"\n\t\t\t\t\t\tvalue={username}\n\t\t\t\t\t\tonChange={(e: React.ChangeEvent<HTMLInputElement>): void => {\n\t\t\t\t\t\t\tsetUsername(e.target.value);\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t</label>\n\t\t\t\t<label htmlFor=\"password\">\n\t\t\t\t\tPassword\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype={clearPswd ? \"text\" : \"password\"}\n\t\t\t\t\t\tname=\"password\"\n\t\t\t\t\t\tvalue={password}\n\t\t\t\t\t\tonChange={(e: React.ChangeEvent<HTMLInputElement>): void =>\n\t\t\t\t\t\t\tsetPassword(e.target.value)\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t</label>\n\t\t\t\t<input\n\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\tchecked={clearPswd}\n\t\t\t\t\tonClick={(): void => setClearPswd(!clearPswd)}\n\t\t\t\t/>\n\t\t\t\t<button onClick={handleLogin}>Login</button>\n\t\t\t</form>\n\n\t\t\t{message && <div>{message}</div>}\n\t\t</div>\n\t);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}